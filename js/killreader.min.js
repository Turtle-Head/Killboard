var Kill=function(c,d){var b=this;b.kill=ko.observable();b.corp=ko.observable(c.victim.corporationID);b.victim=ko.observable(c.victim.characterName);b.url=ko.observable("http://zkillboard.com/kill/"+c.killID+"/");b.shipPic=ko.observable("http://imageserver.eveonline.com/Render/"+c.victim.shipTypeID+"_128.png");b.atkCorp=ko.observableArray([]);for(var a=0;a<c.attackers.length;a++){b.atkCorp().push({pilotkb:"https://zkillboard.com/character/"+c.attackers[a].characterID+"/",corpPic:"http://imageserver.eveonline.com/Corporation/"+c.attackers[a].corporationID+"_32.png",corp:c.attackers[a].corporationName,pilot:c.attackers[a].characterName,pilotP:"http://imageserver.eveonline.com/Character/"+c.attackers[a].characterID+"_32.jpg",shipPic:"http://imageserver.eveonline.com/Type/"+c.attackers[a].shipTypeID+"_32.png",wepPic:"http://imageserver.eveonline.com/Type/"+c.attackers[a].weaponTypeID+"_32.png",corpKB:"http://zkillboard.com/corporation/"+c.attackers[a].corporationID+"/"})}b.involved=ko.observable(c.attackers.length);b.time=ko.observable(c.killTime);b.vicCorpKB=ko.observable("http://zkillboard.com/corporation/"+c.victim.corporationID+"/");b.isk=ko.observable(Number(c.zkb.totalValue).toLocaleString("en",{minimumFractionDigits:2}));b.kval=ko.observable(c.zkb.totalValue);b.points=ko.observable(c.zkb.points);b.vicCorpUrl=ko.observable("http://imageserver.eveonline.com/Corporation/"+c.victim.corporationID+"_32.png");b.vicPic=ko.observable("http://imageserver.eveonline.com/Character/"+c.victim.characterID+"_128.jpg");if(c.victim.corporationID===d){b.kill(false)}else{b.kill(true)}};var UKCR_ID={id:"98270563",porc:"c"};var ViewModel=function(i,f){var b=this;b.killArray=ko.observableArray([]);b.displayKills=ko.observableArray([]);var g=new Date();var h=g.getFullYear();var a=g.getMonth()+1;var c="https://zkillboard.com/api/";if(i&&(f==="p")){c+="characterID/"+i}else{if(i&&(f==="c")){c+="corporationID/"+i+"/year/"+h+"/month/"+a+"/"}else{alert("Error parsing ID!")}}var e=setTimeout(function(){alert("Request Timeout: Failed to get kill data")},8000);$.ajax({url:c,dataType:"jsonp",success:function(j){for(var d=0;d<j.length;d++){ViewModel.killArray().push(j[d]);ViewModel.displayKills().push(new Kill(j[d],i))}console.log(b.displayKills().length);clearTimeout(e)}});console.log("After AJAX");console.log(b.displayKills());console.log(b.displayKills().length);b.won=ko.computed(function(){var j;for(var d=0;d<b.displayKills().length;d++){if(b.displayKills()[d].kill()){j+=b.displayKills()[d].kval();console.log("Kill!")}}return j},this);b.lost=ko.computed(function(){var j;for(var d=0;d<b.displayKills().length;d++){if(!b.displayKills()[d].kill()){j+=b.displayKills()[d].kval();console.log("Loss!")}}return j},this);b.balance=ko.computed(function(){return(b.won()-b.lost())},this);console.log(b.balance())};ko.applyBindings(new ViewModel(UKCR_ID.id,UKCR_ID.porc));