var UKCR_ID="98270563";function loadData(a,f){var e=$("body");var k=$("#results-header");var o=$("#results-articles");var l=$("#greeting");var n=0;var g=0;o.text("");k.text("");var b="";var h=new Date();var j=h.getFullYear();var c=h.getMonth()+1;var p="https://zkillboard.com/api/";if(f){p+="corporationID/"+a+"/year/"+j+"/month/"+c+"/"}else{if(!f){p+="characterID/"+a+"/year/"+j+"/month/"+c+"/"}}var i=setTimeout(function(){o.text("Failed to get kill data")},8000);$.ajax({url:p,dataType:"jsonp",success:function(t){console.log(a);$("#month").append("<th>"+c+"/"+j+"</th>");var A=t;console.log(A);for(var v=0;v<A.length;v++){articleStr=A[v];var m="http://zkillboard.com/kill/"+articleStr.killID+"/";var u="http://imageserver.eveonline.com/Render/"+articleStr.victim.shipTypeID+"_128.png";var D=[];for(var q=0;q<articleStr.attackers.length;q++){D[q]={pilotkb:"https://zkillboard.com/character/"+articleStr.attackers[q].characterID+"/",corpPic:"http://imageserver.eveonline.com/Corporation/"+articleStr.attackers[q].corporationID+"_32.png",corp:articleStr.attackers[q].corporationName,pilot:articleStr.attackers[q].characterName,pilotP:"http://imageserver.eveonline.com/Character/"+articleStr.attackers[q].characterID+"_32.jpg",shipPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[q].shipTypeID+"_32.png",wepPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[q].weaponTypeID+"_32.png",corpKB:"http://zkillboard.com/corporation/"+articleStr.attackers[q].corporationID+"/",id:articleStr.attackers[q].characterID}}var w='<div class="num">'+articleStr.killTime+"</div>";var r='<div class="dat" id="inv">Involved: '+(articleStr.attackers.length)+'<div id="atta">';for(var B=0;B<D.length;B++){r+='<button class="loader" id='+D[B].id+'>Load Kills</button><img src="'+D[B].shipPic+'"><img src="'+D[B].wepPic+'"><a href="'+D[B].corpKB+'"><img src="'+D[B].corpPic+'" alt="'+D[B].corp+'"></a>  <a href="'+D[B].pilotkb+'"><img src="'+D[B].pilotP+'">  '+D[B].pilot+"</a><br>"}r+="</div></div>";var s="http://zkillboard.com/corporation/"+articleStr.victim.corporationID+"/";var z=Number(articleStr.zkb.totalValue).toLocaleString("en",{minimumFractionDigits:2});var C='<div class="dat"><div class="dat2">ISK Value: <div class="num">'+z+'</div></div><div class="dat2"> Points: '+articleStr.zkb.points+"</div>"+w+"</div>";var x="http://imageserver.eveonline.com/Corporation/"+articleStr.victim.corporationID+"_128.png";var y="http://imageserver.eveonline.com/Character/"+articleStr.victim.characterID+"_128.jpg";var d='<td><button class="loader" id='+articleStr.victim.characterID+'">Load Kills</button></td><td class="image"><a href="'+m+'"><img src="'+u+'"><img src="'+y+'"></a><a href="'+s+'"><img src="'+x+'"></td><td class="ids"><a href="'+m+'">'+articleStr.victim.characterName+'</a><br> Corp: <a href="'+s+'">'+articleStr.victim.corporationName+"</a>"+C+'</td><td class="attackers">'+r+"</li></td></tr>";if((Number(articleStr.victim.corporationID)!==Number(a))&&(Number(articleStr.victim.characterID)!==Number(a))){o.append('<tr class="kill">'+d);g+=articleStr.zkb.totalValue}else{o.append('<tr class="loss">'+d);n+=articleStr.zkb.totalValue}}$("#diff").text("");if((g-n)>0){$("#diff").append('<div class="kill">Kills: '+Number(g).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(n).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="kill">[+/-]: '+Number(g-n).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}else{if((g-n)<0){$("#diff").append('<div class="loss">Kills: '+Number(g).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(n).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">[+/-]: '+Number(g-n).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}}clearTimeout(i)}});return false}$(document).on("click",".loader",function(){var a=this.id;loadData(a,false)});$("#form-container").click(function(){loadData(UKCR_ID,true)});$(document).ready(function(){loadData(UKCR_ID,true)});