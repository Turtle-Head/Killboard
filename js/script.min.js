var UKCR_ID="98270563";function loadData(a,f){var e=$("body");var k=$("#results-header");var o=$("#results-articles");var l=$("#greeting");var n=0;var g=0;o.text("");k.text("");var b="";var h=new Date();var j=h.getFullYear();var c=h.getMonth()+1;var p="https://zkillboard.com/api/";if(f){p+="corporationID/"+a+"/year/"+j+"/month/"+c+"/"}else{if(!f){p+="characterID/"+a+"/year/"+j+"/month/"+c+"/"}}var i=setTimeout(function(){o.text("Failed to get kill data")},8000);$.ajax({url:p,dataType:"jsonp",success:function(t){console.log(a);$("#month").text(c+"/"+j);var B=t;console.log(B);for(var v=0;v<B.length;v++){articleStr=B[v];var m="http://zkillboard.com/kill/"+articleStr.killID+"/";var u="http://imageserver.eveonline.com/Render/"+articleStr.victim.shipTypeID+"_128.png";var E=[];for(var q=0;q<articleStr.attackers.length;q++){E[q]={pilotkb:"https://zkillboard.com/character/"+articleStr.attackers[q].characterID+"/",corpPic:"http://imageserver.eveonline.com/Corporation/"+articleStr.attackers[q].corporationID+"_32.png",corp:articleStr.attackers[q].corporationName,pilot:articleStr.attackers[q].characterName,pilotP:"http://imageserver.eveonline.com/Character/"+articleStr.attackers[q].characterID+"_32.jpg",shipPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[q].shipTypeID+"_32.png",wepPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[q].weaponTypeID+"_32.png",corpKB:"http://zkillboard.com/corporation/"+articleStr.attackers[q].corporationID+"/",id:articleStr.attackers[q].characterID,cid:articleStr.attackers[q].corporationID};if(Number(a)===Number(articleStr.attackers[q].characterID)){$("#killBoard").text(articleStr.attackers[q].characterName)}else{if(Number(a)===Number(articleStr.attackers[q].corporationID)){$("#killBoard").text(articleStr.attackers[q].corporationName)}}}if(Number(a)===Number(articleStr.victim.characterID)){$("#killBoard").text(articleStr.victim.characterName)}else{if(Number(a)===Number(articleStr.victim.corporationID)){$("#killBoard").text(articleStr.victim.corporationName)}}var w='<div class="num">'+articleStr.killTime+"</div>";var r='<div class="dat" id="inv">Involved: '+(articleStr.attackers.length)+'<div id="atta">';for(var C=0;C<E.length;C++){r+='<img src="'+E[C].shipPic+'"><img src="'+E[C].wepPic+'"><img class="cload" id='+E[C].cid+' src="'+E[C].corpPic+'" alt="'+E[C].corp+'">  <a href="#" class="pload" id='+E[C].id+'><img src="'+E[C].pilotP+'">  '+E[C].pilot+"</a><br>"}r+="</div></div>";var s="http://zkillboard.com/corporation/"+articleStr.victim.corporationID+"/";var A=Number(articleStr.zkb.totalValue).toLocaleString("en",{minimumFractionDigits:2});var D='<div class="dat"><div class="dat2">ISK Value: <div class="num">'+A+'</div></div><div class="dat2"> Points: '+articleStr.zkb.points+"</div>"+w+"</div>";var x="http://imageserver.eveonline.com/Corporation/"+articleStr.victim.corporationID+"_128.png";var z="http://imageserver.eveonline.com/Character/"+articleStr.victim.characterID+"_128.jpg";var d='<td class="image"><a href="'+m+'"><img src="'+u+'"><img src="'+z+'"></a><a href="'+s+'"><img src="'+x+'"></td>';var y='<td class="ids"><a href="#" class="pload" id='+articleStr.victim.characterID+">"+articleStr.victim.characterName+'</a><br> Corp: <a href="#" class="cload" id='+articleStr.victim.corporationID+">"+articleStr.victim.corporationName+"</a>"+D+'</td><td class="attackers">'+r+"</td></tr>";if((Number(articleStr.victim.corporationID)!==Number(a))&&(Number(articleStr.victim.characterID)!==Number(a))){o.append('<tr class="kill">'+d+y);g+=articleStr.zkb.totalValue}else{o.append('<tr class="loss">'+d+y);n+=articleStr.zkb.totalValue}}$("#diff").text("");if((g-n)>0){$("#diff").append('<div class="kill">Kills: '+Number(g).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(n).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="kill">[+/-]: '+Number(g-n).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}else{if((g-n)<0){$("#diff").append('<div class="loss">Kills: '+Number(g).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(n).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">[+/-]: '+Number(g-n).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}}clearTimeout(i)}});return false}$(document).on("click",".pload",function(){var a=this.id;loadData(a,false)});$(document).on("click",".cload",function(){var a=this.id;loadData(a,true)});$(document).ready(function(){loadData(UKCR_ID,true)});