var UKCR_ID="98270563";var FM_ID="98398761";var LONE_ID="652229108";var displayStats=function(r){var m=r.length;if(m>1){var s=0;for(var n=0;n<m;n++){if(r[s].points<r[n].points){s=n}}var c=0;for(var h=0;h<m;h++){if(r[c].kills<r[h].kills){c=h}}var b=0;for(var g=0;g<m;g++){if(r[b].won<r[g].won){b=g}}var f=0;for(var d=0;d<m;d++){if(r[f].losses<r[d].losses){f=d}}var t="";var a='<tr class="aw_el"><td class="award">Top Points Award</td><td class="pload" id='+r[s].id+"><img src="+r[s].pic+'></td><td><a href="#" class="pload" id='+r[s].id+" >"+r[s].name+"</a></td><td>"+r[s].points+"</td></tr>";var q='<tr class="aw_el"><td class="award">Top Kills Award</td><td class="pload" id='+r[c].id+"><img src="+r[c].pic+'></td><td><a href="#" class="pload" id='+r[c].id+" >"+r[c].name+"</a></td><td>"+r[c].kills+"</td></tr>";var p='<tr class="aw_el"><td class="award">Top ISK Destroyed Award</td><td class="pload" id='+r[b].id+"><img src="+r[b].pic+' ></td><td><a href="#" class="pload" id='+r[b].id+" >"+r[b].name+"</a></td><td>"+Number(r[b].won).toLocaleString("en",{minimumFractionDigits:2})+"</td></tr>";var o='<tr class="aw_el"><td class="award">Top Losses</td><td class="pload" id='+r[f].id+"><img src="+r[f].pic+'></td><td><a href="#" class="pload" id='+r[f].id+" >"+r[f].name+"</a></td><td>"+r[f].losses+"</td></tr>";if(r[b].won!==0){t+=p}if(r[s].points!==0){t+=a}if(r[c].kills!==0){t+=q}if(r[f].losses!==0){t+=o}$("#statistics").text("");$("#statistics").append(t)}if(m===1){var e='<tr class="aw_el"><td class="pload" id='+r[0].id+"><img src="+r[0].pic+' ></td><td><a href="#" class="pload" id='+r[0].id+" >"+r[0].name+'</a></td><td><a href="#" class="cload" id='+r[0].cid+" >"+r[0].corp+"</a></td>";e+="<td>Points: "+r[0].points+"</td><td>Kills: "+r[0].kills+"</td><td>Losses: "+r[0].losses+"</td></tr>";$("#statistics").text("");$("#statistics").append(e)}};function findWithAttr(c,b){for(var a=0;a<c.length;a+=1){if(Number(c[a].id)===Number(b)){return a}}}var stats=function(a,h,b){var n=false;var m=[];if(Number(a)===Number(h)){n=true}if(n){for(var c=0;c<b.length;c++){if(Number(b[c].victim.corporationID)===Number(a)){var j=findWithAttr(m,Number(b[c].victim.characterID))||null;if((!j)&&((m.length!==1)||(Number(m[0].id)!==Number(b[c].victim.characterID)))){m.push({name:b[c].victim.characterName,id:b[c].victim.characterID,corp:b[c].victim.corporationName,cid:b[c].victim.corporationID,won:0,lost:b[c].zkb.totalValue,points:0-b[c].zkb.points,kills:0,losses:1,pic:"http://imageserver.eveonline.com/Character/"+b[c].victim.characterID+"_32.jpg"})}else{if(j){m[j].lost+=b[c].zkb.totalValue;m[j].points-=b[c].zkb.points;m[j].losses+=1}else{if((m.length===1)&&(Number(m[0].id)===Number(b[c].victim.characterID))){m[0].lost+=b[c].zkb.totalValue;m[0].points-=b[c].zkb.points;m[0].losses+=1}}}}for(var l=0;l<b[c].attackers.length;l++){if(Number(b[c].attackers[l].corporationID)===Number(a)){var k=findWithAttr(m,Number(b[c].attackers[l].characterID))||null;if((!k)&&((m.length!==1)||(Number(m[0].id)!==Number(b[c].attackers[l].characterID)))){m.push({name:b[c].attackers[l].characterName,id:b[c].attackers[l].characterID,corp:b[c].attackers[l].corporationName,cid:b[c].attackers[l].corporationID,won:b[c].zkb.totalValue,lost:0,points:b[c].zkb.points,kills:1,losses:0,pic:"http://imageserver.eveonline.com/Character/"+b[c].attackers[l].characterID+"_32.jpg"})}else{if(k){m[k].won+=b[c].zkb.totalValue;m[k].points+=b[c].zkb.points;m[k].kills+=1}else{if((m.length===1)&&(Number(m[0].id)===Number(b[c].attackers[l].characterID))){m[0].won+=b[c].zkb.totalValue;m[0].points+=b[c].zkb.points;m[0].kills+=1}}}}}}}if(!n){for(var f=0;f<b.length;f++){if(Number(b[f].victim.characterID)===Number(a)){if(m[0]===undefined){m.push({name:b[f].victim.characterName,id:b[f].victim.characterID,corp:b[f].victim.corporationName,cid:b[f].victim.corporationID,won:0,lost:b[f].zkb.totalValue,points:-b[f].zkb.points,kills:0,losses:1,pic:"http://imageserver.eveonline.com/Character/"+b[f].victim.characterID+"_32.jpg"})}else{m[0].lost+=b[f].zkb.totalValue;m[0].points-=b[f].zkb.points;m[0].losses+=1}}for(var d=0;d<b[f].attackers.length;d++){if(Number(b[f].attackers[d].characterID)===Number(a)){if(m[0]===undefined){m.push({name:b[f].attackers[d].characterName,id:b[f].attackers[d].characterID,corp:b[f].attackers[d].corporationName,cid:b[f].attackers[d].corporationID,won:b[f].zkb.totalValue,lost:0,points:b[f].zkb.points,kills:1,losses:0,pic:"http://imageserver.eveonline.com/Character/"+b[f].attackers[d].characterID+"_32.jpg"})}else{m[0].won+=b[f].zkb.totalValue;m[0].points+=b[f].zkb.points;m[0].kills+=1}}}}}displayStats(m)};function loadData(a,g){var f=$("body");var l=$("#results-header");var q=$("#results-articles");var n=$("#greeting");var p=0;var h=0;var o=false;var b;q.text("");l.text("");var c="";var i=new Date();var k=i.getFullYear();var e=i.getMonth()+1;var r="https://zkillboard.com/api/";if(g){r+="corporationID/"+a+"/year/"+k+"/month/"+e+"/"}else{if(!g){r+="characterID/"+a+"/year/"+k+"/month/"+e+"/"}}var j=setTimeout(function(){q.text("Failed to get kill data")},8000);$.ajax({url:r,dataType:"jsonp",success:function(v){$("#month").text(e+"/"+k);var D=v;for(var x=0;x<D.length;x++){articleStr=D[x];var m="http://zkillboard.com/kill/"+articleStr.killID+"/";var w="http://imageserver.eveonline.com/Render/"+articleStr.victim.shipTypeID+"_128.png";var G=[];for(var s=0;s<articleStr.attackers.length;s++){G[s]={pilotkb:"https://zkillboard.com/character/"+articleStr.attackers[s].characterID+"/",corpPic:"http://imageserver.eveonline.com/Corporation/"+articleStr.attackers[s].corporationID+"_32.png",corp:articleStr.attackers[s].corporationName,pilot:articleStr.attackers[s].characterName,pilotP:"http://imageserver.eveonline.com/Character/"+articleStr.attackers[s].characterID+"_32.jpg",shipPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[s].shipTypeID+"_32.png",wepPic:"http://imageserver.eveonline.com/Type/"+articleStr.attackers[s].weaponTypeID+"_32.png",corpKB:"http://zkillboard.com/corporation/"+articleStr.attackers[s].corporationID+"/",id:articleStr.attackers[s].characterID,cid:articleStr.attackers[s].corporationID};if(!o){if(Number(a)===Number(articleStr.attackers[s].characterID)){$("#greeting").text(articleStr.attackers[s].characterName);$(".bgimg").attr("src","http://imageserver.eveonline.com/Corporation/"+articleStr.attackers[s].corporationID+"_128.png");b=articleStr.attackers[s].corporationID;o=true;stats(a,b,D)}else{if(Number(a)===Number(articleStr.attackers[s].corporationID)){$("#greeting").text(articleStr.attackers[s].corporationName);$(".bgimg").attr("src","http://imageserver.eveonline.com/Corporation/"+articleStr.attackers[s].corporationID+"_128.png");b=articleStr.attackers[s].corporationID;o=true;stats(a,b,D)}}}}if(!o){if(Number(a)===Number(articleStr.victim.characterID)){$("#greeting").text(articleStr.victim.characterName);$(".bgimg").attr("src","http://imageserver.eveonline.com/Corporation/"+articleStr.victim.corporationID+"_128.png");b=articleStr.victim.corporationID;o=true;stats(a,b,D)}else{if(Number(a)===Number(articleStr.victim.corporationID)){$("#greeting").text(articleStr.victim.corporationName);$(".bgimg").attr("src","http://imageserver.eveonline.com/Corporation/"+articleStr.victim.corporationID+"_128.png");b=articleStr.victim.corporationID;o=true;stats(a,b,D)}}}var y='<div class="num">'+articleStr.killTime+"</div>";var t='<div class="dat" id="inv">Involved: '+(articleStr.attackers.length)+'<div id="atta">';for(var E=0;E<G.length;E++){t+='<img src="'+G[E].shipPic+'"><img src="'+G[E].wepPic+'"><img class="cload" id='+G[E].cid+' src="'+G[E].corpPic+'" alt="'+G[E].corp+'">  <a href="#" class="pload" id='+G[E].id+'><img src="'+G[E].pilotP+'">  '+G[E].pilot+"</a><br>"}t+="</div></div>";var u="http://zkillboard.com/corporation/"+articleStr.victim.corporationID+"/";var C=Number(articleStr.zkb.totalValue).toLocaleString("en",{minimumFractionDigits:2});var F='<div class="dat"><div class="dat2">ISK Value: <div class="num">'+C+'</div></div><div class="dat2"> Points: '+articleStr.zkb.points+"</div>"+y+"</div>";var z="http://imageserver.eveonline.com/Corporation/"+articleStr.victim.corporationID+"_128.png";var B="http://imageserver.eveonline.com/Character/"+articleStr.victim.characterID+"_128.jpg";var d='<td class="image"><a href="'+m+'"><img src="'+w+'"><img src="'+B+'"></a><a href="'+u+'"><img src="'+z+'"></td>';var A='<td class="ids"><a href="#" class="pload" id='+articleStr.victim.characterID+">"+articleStr.victim.characterName+'</a><br> Corp: <a href="#" class="cload" id='+articleStr.victim.corporationID+">"+articleStr.victim.corporationName+"</a>"+F+'</td><td class="attackers">'+t+"</td></tr>";if((Number(articleStr.victim.corporationID)!==Number(a))&&(Number(articleStr.victim.characterID)!==Number(a))){q.append('<tr class="kill">'+d+A);h+=articleStr.zkb.totalValue}else{q.append('<tr class="loss">'+d+A);p+=articleStr.zkb.totalValue}}$("#diff").text("");if((h-p)>0){$("#diff").append('<div class="kill">Kills: '+Number(h).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(p).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="kill">[+/-]: '+Number(h-p).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}else{if((h-p)<0){$("#diff").append('<div class="loss">Kills: '+Number(h).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">Losses: '+Number(p).toLocaleString("en",{minimumFractionDigits:2})+' ISK</div><div class="loss">[+/-]: '+Number(h-p).toLocaleString("en",{minimumFractionDigits:2})+" ISK</div>")}}clearTimeout(j)}});return false}$(document).on("click",".pload",function(){var a=this.id;loadData(a,false)});$(document).on("click",".cload",function(){var a=this.id;loadData(a,true)});$(document).ready(function(){loadData(UKCR_ID,true)});